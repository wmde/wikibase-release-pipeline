version: '3.4'

x-common-variables: &elastic_search
  MW_ELASTIC_HOST: ${MW_ELASTIC_HOST}
  MW_ELASTIC_PORT: ${MW_ELASTIC_PORT}

services:

  test-runner:
    environment: 
      <<: *elastic_search

  wikibase:
    volumes:
      - ./suite-config/${SUITE_CONFIG_NAME}/wikibase-extra-install.sh:/extra-install.sh
    environment: 
      <<: *elastic_search

  wikibase-jobrunner:
    environment:
      <<: *elastic_search

  elasticsearch:
    image: "${ELASTICSEARCH_IMAGE_NAME}"
    restart: unless-stopped
    networks:
      default:
        aliases:
         - elasticsearch.svc
    environment:
      discovery.type: single-node
      ES_JAVA_OPTS: "-Xms512m -Xmx512m"
