# Wikibase override for testing client-repo setups
version: '3.4'

x-common-variables: &wikibase_extra_variables
  MW_ELASTIC_HOST: ${MW_ELASTIC_HOST}
  MW_ELASTIC_PORT: ${MW_ELASTIC_PORT}

services:

  wikibase-test:
    build:
      context: ../Docker/test/curl/
      dockerfile: Dockerfile
    volumes:
      - ./suite-config/elasticsearch/curl-test/entrypoint.sh:/entrypoint.sh
    entrypoint: /bin/sh
    command:  /entrypoint.sh
    environment: 
      <<: *wikibase_extra_variables

  wikibase:
    environment: 
      <<: *wikibase_extra_variables
    volumes:
      - ./suite-config/elasticsearch/wikibase/extra-install.sh:/extra-install.sh

  wikibase_jobrunner:
    environment:
      <<: *wikibase_extra_variables

volumes:
  LocalSettings:
